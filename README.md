                         _                           
    __   _____  ___ _ __(_)_   _____ _ __   ___ _ __ 
    \ \ / / __|/ __| '__| \ \ / / _ \ '_ \ / _ \ '__|
     \ V /\__ \ (__| |  | |\ V /  __/ | | |  __/ |   
      \_/ |___/\___|_|  |_| \_/ \___|_| |_|\___|_|   


## Introduction
vscode setup and support to allow writers to emulate some of the features of Scrivener. No, it's not really Scrivener, but you're here because you wanted to do your writing in vscode and markdown.
## Install

1. Download this repo - you'll use this directory name to correctly adjust the extension settings later
1. Install extensions [HTML Preview](https://marketplace.visualstudio.com/items?itemName=george-alisson.html-preview-vscode), [Run on Save](https://marketplace.visualstudio.com/items?itemName=emeraldwalk.RunOnSave), [Section Word Count](https://marketplace.visualstudio.com/items?itemName=witulski.section-word-count-targets), [Spell Right](https://marketplace.visualstudio.com/items?itemName=ban.spellright), [Word Count](https://marketplace.visualstudio.com/items?itemName=ms-vscode.wordcount)
2. Optionally install extensions [TODO Highlight](https://marketplace.visualstudio.com/items?itemName=wayou.vscode-todo-highlight), [Graphviz Interactive Preview](https://marketplace.visualstudio.com/items?itemName=tintinweb.graphviz-interactive-preview) (or similar). I really like TODO highlighting when I'm writing.
3. Install `pandoc`, `graphviz`, `Lua`, and `php` on your system. `pandoc` is kinda mandatory. `graphviz` and `Lua` are for `dot` syntax support, `php` is for the MLA citation script: these are optional.
4. Configure extensions starting with `extension-settings-example.json` and adjust paths to where you installed the vscrivener repo
5. Copy the `Documents` subdirectory out of this repo to another subdir where you will store your writing

## Features
### Arbitrary document structure
You can use the file_order.txt file to let pandoc how you want things ordered. Could be one big md file, could be multiple chapters in subdirectories. file_order.txt is just a list of file paths that build.sh cat's.
### Word count, Section Word Count
* note that the section word count doesn't work for parent sections that have subsections, eg.

```
# INTRODUCTION (Target: 1000) <--- this doesn't work
## Thesis statement (Target: 400) <--- this does
```

### Spell checker (From the Spell Right extension)
### dot support
You can embed graphviz stuff in your document and have the output image in the HTML preview.

### Live HTML preview
The combination of Run On Save and HTML Preview provides an html rendering of your document. On save you can see an 'output' subdirectory created with your document. Opening that html file in vscode and then clicking the side-by-side preview will display an up-to-date rendering.

### Research
The `Research/research.txt` is a poor man's version of Scrivener's research concept. vscode doesn't appear to have a browser that can run in it so URL's have to be viewed in an external browser. See also the section on MLA citations.
### MLA citations from URLs in research.txt for easier footnotes
The research.txt is a poor man's version of Scrivener's research concept. vscode doesn't appear to have a browser that can run in it so URL's have to be viewed in an external browser. 

#### How to use citations and footnotes:

Your `footnotes.md` file (as specified in `file_order.txt`) can have MLA citations automagically generated from `Research/citations.txt`. This allows you just paste relevant URL's in your citations.txt and have them converted into MLA citations using as much of the metadata as possible from the remote site. It also allows you to specify `:raw:` citations (ie. ones you created yourself) and `:section:`'s of URLs so that the footnotes are a little more manageable in your document. You can see examples of this in `Documents/Essay/`. Here's how it works.

In `Research/citations.txt` you add the URL of a website you need to cite in your document. Maybe you have 3 URLs that are all related to apples and two that relate to oranges.

```
https://www.cnn.com
:section: Apples
https://en.wikipedia.org/wiki/Apple
https://parade.com/1330308/bethlipton/types-of-apples/

:raw: Apples of North America: A Celebration of Exceptional Varieties, Tom Burford, Timber Press, September 28, 2021
:section: Oranges
https://en.wikipedia.org/wiki/Orange

:raw: 2Apples of North America: A Celebration of Exceptional Varieties, Tom Burford, Timber Press, September 28, 2021
:raw: Oranges of North America: A Celebration of Exceptional Varieties, Tom Burford, Timber Press, September 28, 2021
```

When you save citations.txt, the Run On Save extension is setup to run `citations.sh`. This edits your footnotes.md file after the special `<!--- CITATIONS_AUTO_ADDED_BELOW Everything below this line is autogenerated when you save Research/citations.txt -->` comment, eg. 

```
[^aaa]: Here is the footnote.
[^bbb]: Here is the second footnote.

<!--- CITATIONS_AUTO_ADDED_BELOW Everything below this line is autogenerated when you save Research/citations.txt -->

[^URL1]: --. "CNN - Breaking News, Latest News and Videos." CNN, www.cnn.com, --, https://www.cnn.com
[^Apples1]: --. "Apple - Wikipedia." en.wikipedia.org, en.wikipedia.org, --, https://en.wikipedia.org/wiki/Apple
[^Apples2]: --. "parade.com." parade.com, parade.com, --, https://parade.com/1330308/bethlipton/types-of-apples/
[^RAW1]: Apples of North America: A Celebration of Exceptional Varieties, Tom Burford, Timber Press, September 28, 2021
[^Oranges1]: --. "Orange - Wikipedia." en.wikipedia.org, en.wikipedia.org, --, https://en.wikipedia.org/wiki/Orange
[^RAW2]: 2Apples of North America: A Celebration of Exceptional Varieties, Tom Burford, Timber Press, September 28, 2021
[^RAW3]: Oranges of North America: A Celebration of Exceptional Varieties, Tom Burford, Timber Press, September 28, 2021
```

Every time you edit/save `Research/citations.txt` it reruns the script and modifies your `footnotes.md`.

You can safely use these footnote references in your markdown, eg. 

```
There were lots of types of apples. [^Apples1]
```

Note that reordering your list of URLs in citations.txt _will renumber your footnotes for that section_. You should just add new URLs to the end of a given `:section:`. The final output document just uses numbers `1..N` for footnote numbers and is wholly separate from the numbers in `Apples1` and `Apples2`: the `:section:` is purely for easier grouping of footnotes.
### Metadata support 
pandoc will place this in your html output for title, description, author, tags, etc.

## Future ideas
* Support other output formations (eg. epub) - this should be straightforward given pandoc support
* better/different citation support
* maybe a research solution like Scrivener where they load and save research URLs for offline reading?
* fix images in dot syntax
## Troubleshooting

* View->Output, select Run On Save from view pane, then edit and save one of your md files to see the output from the build.sh script. You can also use this to debug the citations.sh script when you save `citations.txt`.
* you have to have the output/[yourdoc].html file open in vscode for the live preview pane to update on save
* see note above on Section Word Count
* having issues with images in the dot syntax so that needs to get fixed